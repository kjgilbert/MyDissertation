\chapter{Conclusion}
\label{chap:conclusions}

The field of population genetics has grown by leaps and bounds since its advent. The rapid advancement of genetic and genomic techniques for acquiring data from every organism imaginable is a testament to this growth, as well as a cause. The insights allowed through these advances have greatly informed all aspects of evolutionary biology today. Even though I have not presented new data from natural organisms, my thesis work, and all theoretical work broadly, relies heavily on biological data collected by evolutionary biologists through the years. We gain a great deal of knowledge by creating models of the natural world where alteration of specific factors can be controlled and investigated. Models that are based in reality with biologically accurate parameters not only improve our understanding of population genetic processes, but also have more directly applicable insights for real world populations.

I have presented four projects within my thesis, each building upon the abundance of existing knowledge in the field of evolutionary biology. In \Chapref{effectivepopsize}, I tested the accuracy of methods designed for estimating effective population sizes. Out of a range of existing methods, I found two of these to perform best. Furthermore, I found that of these two methods the best-performing method varied across different demographic scenarios of migration among populations. This lends credit to the proposition made throughout my thesis that knowing the demographic history of populations is both useful and necessary to make proper evolutionary inferences from data.

In \Chapref{expansionload}, I examined range expansions with combinations of conditions generating expansion load, local maladaptation to an environmental gradient, or both. I found an interesting interaction between these two factors. Rather than the combination of both expansion load and local maladaptation to an environmental gradient worsening fitness at range edges, they instead act in conjunction to alleviate fitness reductions at expanding fronts. When fitness reductions caused by expansion load accumulated at expanding range fronts combines with the fitness costs incurred as populations attempt to adapt to the local environment over steep gradients, these effects compound and lead to the local extinction of populations at the range edge. This leaves behind a surviving range edge necessarily consisting of more locally adapted individuals. Because any lower degree of local adaptation would combine with expansion load to generate populations with unsustainable fitness levels, those populations simply no longer exist, and local adaptation in the surviving range edge is higher while range expansion is slower. This slower range expansion therefore means that the range edge occurs sooner in space than it would otherwise in the absence of either expansion load or local maladaptation to an environmental gradient.

In \Chapref{heterogeneouslandscapes}, I simulated range expansions with different genetic architectures across environmental gradients that varied over space in terms of patchiness and steepness. Varying the genetic architecture of the trait underlying adaptation to the environment showed different abilities of populations to adapt and expand their ranges. Two qualitatively different regimes resulted whereby expansion could succeed from either many small effect alleles or few large effect alleles. Intermediate between these two regimes, expansion was more limited, indicating that this may be parameter space for which adaptation is most difficult. Though the upper bound of the mutation rates included may be unrealistic, this result provides impetus for future investigation of the interaction between mutation numbers, effect sizes, and the scale of change in the environment.

In \Chapref{reproducibility}, I presented a reproducibility study on published datasets using the widespread analysis method \textsc{structure}. We found that the same biological result of $K$ values could be reproduced in 70\% of studies. However, if the success of reproducibility was measured from the starting point of searching and acquiring the datasets for which reanalyses were performed, rather than out of the datasets successfully acquired, this percentage would decrease greatly. This implies that the largest issue in this reproducibility study is not the analysis itself, but in obtaining the necessary data. These results are nonetheless promising, as they indicate the successful repeatability of a stochastic genetic analysis method. It would be interesting to conduct a similar reproducibility study today, since the standards for data archiving have greatly improved in the four years since publication of this study. Furthermore, it would be even more valuable if it were feasible to do such a large-scale reproducibility study in the true sense of the word, whereby new data would be collected in the same systems and analyzed to test if the same biological conclusion for population clustering is obtained from independent sampling efforts.

%%% Investigating further parameter space around these simulation as well as investigating other biologically realistic possibilities such as evolution of dispersal provide ample future directions for this research.



Each of my thesis projects has its own limitations as well as its own implications that leave open interesting avenues for future research. The simulation studies in \Chapref{effectivepopsize, expansionload, heterogeneouslandscapes} each investigate a specific range of parameter sets, as computational resources are limited. We chose the combinations of parameters and scenarios deemed to be most relevant to the questions of interest as well as most biologically relevant for applied uses. Analytical models may serve better to describe the range of parameter space where certain interactions are expected to be most interesting or of greatest effect, but approaching these questions through simulations has provided insight not otherwise accessible through analytical models. In particular, \Chapref{expansionload, heterogeneouslandscapes} have used spatially explicit simulations over large scale landscapes to investigate range expansions. Such an approach is computationally intensive and has not been used in previous studies of range expansion on this scale. The biological realism introduced by this approach allowed me to directly investigate the specific biology of the questions in mind, especially in \Chapref{heterogeneouslandscapes} where the structure of the landscape is a key aspect under investigation. This simulation approach has been made publicly available for others to use in future studies and will hopefully allow continued biological insight into population genetic processes occurring in large scale landscapes.

The simulated data generated from \Chapref{effectivepopsize} was designed to test biological scenarios most relevant to scenarios occurring during estimation of effective population size in natural populations. Testing all methods available at the time on this range of data was the first fair comparison method to method. As new methods for estimating effective population size have been developed, this data will continue to be valuable in further comparisons. Since publication of \Chapref{effectivepopsize}, a new method \citep{Hui:2015} has been created that I hope to test in the future across all scenarios already investigated in my study. A new study has also performed a comparison across a subset of these methods to test their performance in a different range of biological scenarios as well as with differing effects of genetic markers on these inferences \citep{Wang:2016}. The increasing trend of methods testing and comparison may be best seen for methods estimating effective population size. Several previous studies have presented assessments of method performance \citep{Barker:2011, Hoehn:2012, Holleley:2013, Neel:2013, Ryman:2013}, and authors who develop these methods generally present an evaluation of their approach upon publication. This method testing is vital, but often lacks consistency in comparison across methods and datasets, resulting in a comparison of apples to oranges. Methods testing can be difficult and time-consuming, however, and no author is generally able to predict all situations for which their method may be applied. The burden thus rests on researchers applying these methods to ensure that they are meeting the appropriate assumptions of the method, or to first test how applying a method may be biased in their biological scenario.

A great proposal which has yet to come to fruition is the idea to maintain an online database of simulated data for methods testing. I participated in a NESCent working group initiated by MC Whitlock for this SimBank project, where we developed ideas for designing and implementing this database. Such a bank of simulated data would provide standards for comparisons that different researchers could use across methods or to compare a novel method on an equivalent dataset that has already been tested. Simulated data allows accurate assessment of analysis results because the true parameters or biological answers within the simulated data are known. This would also increase the ease of methods testing, as authors do not have to continually generate their own test datasets. Furthermore, researchers applying a method to a dataset with a new scenario that may violate the assumptions built into the method would be able to find equivalent simulated data and test the method themselves in order to understand how useful and accurate the method may be in their scenario. The finalization of this sort of database would be a great boon to advancing population genetic analyses, particularly as more genetic analysis methods are developed. As more data, simulated and natural, continues to be archived at publication and resources for long-term storage and access to data grow, the state of data availability is optimistic for evolutionary biology, making the incorporation of such datasets into a resource for methods testing feasible.

The insight gained from \Chapref{effectivepopsize} has already prompted my participation in two studies of effective population size in real datasets of scenarios violating the assumptions of these estimation methods. I am working with collaborators on a dataset consisting of a metapopulation of the weedy species \emph{Silene latifolia} for which there is long-term census data and multi-year genetic data allowing the comparison of effective population size measures through time and at different hierarchical levels of population structure in relation to the colonization-extinction dynamics of this metapopulation. Furthermore, collaborators interested in the effective population size of an endangered species of stickleback have conducted a mark-recapture study in two lakes within British Columbia where distinct groups of benthic and limnetic fish live. Comparing census sizes to effective population sizes in this system will provide insight into the dynamics between the fish morphs and their respective levels of diversity for conservation purposes.

With the relative ease of acquiring genetic and genomic data, population genetics is more able than ever to compare theoretical predictions to thorough biological analyses. Results from \Chapref{expansionload} make predictions for the range of effect sizes of deleterious mutations we may expect to see accumulating due to range expansion. Empirical studies have shown various results for the effects of deleterious alleles persisting in human populations \citep{Lohmueller:2008, Henn:2015, Do:2015}. Detecting small effect loci in real datasets is extremely difficult, compounded by the statistical problem of comparing across huge sets of loci. It will therefore be worthwhile to compare the values found in empirical studies to those predicted from our simulations. This has the potential to inform studies of expansion load in terms of what portion of small effect loci are unable to be detected but likely still contributing to expansion load, adding to the commentary on how important expansion load may actually be in the real world. As there is still only little empirical evidence on the distribution of effect sizes across species' genomes, further simulations with additional loci may lead to valuable insight. I saw that the effects of multiple loci on fitness and adaptation did not combine multiplicatively, but instead interacted. This both lends credit to as well as points out the faults in learning biology from simplified models. Our model clearly improved upon any using simply one locus. If one were to predict the effects on population survival during range expansion by extrapolating from a one-locus model, the result would be highly unrealistic, as adding more loci creates the potential for ever-increasing interactions. Such interactions are likely to be rife throughout biology, and understanding these interactions through controlled simulation experiments becomes valuable for creating a strong foundation of predictions to be tested in real world data. 

Relevant to both of my studies on range expansions are a wide range of further biological scenarios that merit investigation. A range of mating systems may result in different values of both expansion speed and fitness during range expansions. \Chapref{expansionload} used hermaphrodites capable of selfing, while \Chapref{heterogeneouslandscapes} used obligately outcrossing hermaphroditic individuals. The lack of selfing may slow range expansion (which is not directly comparable across these two studies) also leading to further reductions in expansion load. If the simulated mating system was designed to represent plant species where pollen travels farther than seeds, this may also have implications for expansion load and local adaptation during expansion, as the speed of expansion would be limited by seeds, but migration load could be generated by much wider-ranging pollen movement \citep{Lopez:2008}. More importantly, along these lines is the potential for the evolution of dispersal, which I did not incorporate into our models. As discussed in each chapter, this has the potential to interact with range expansions in unpredictable ways.

An additional characteristic I plan to examine in relation to range expansions is a different process called a range shift, where not only is there an expanding front edge of a population spreading geographically, but there is also a receding trailing edge. This scenario can be imagined in many cases of species tracking moving climatic changes, where the trailing edge is going extinct as it is no longer able to adapt to the local conditions. In these scenarios, there is no dense population core that persists. We may expect there to be less recovery from expansion load that accumulates at the front, as beneficial diversity is lost from the receding edge. In the case where such a shift occurs over heterogeneous landscapes, however, it may in some cases be a beneficial scenario. It is possible that migration load from differently adapted populations at the receding edge of the species range may be less severe because those populations are less different than the expanding front and also not subject to further migration load from a dense core. The conditions for speed of expansion, size of species range, and scale of environmental change over space for such a scenario require further simulations. One further valuable examination relevant to \Chapref{heterogeneouslandscapes} is to compare across a wider range of genetic architecture regimes. Varying the number of loci contributing to the quantitative trait while still maintaining the same values of genetic variance or mutational variance will improve our understanding of the role that different types of genetic architecture play in local adaptation.

Since publication of \Chapref{reproducibility}, we have published two follow-up studies investigating the availability of archived \citep{Vines:2013} and non-archived \citep{Vines:2014} data. In combination, these studies have highlighted the benefit of archiving data for future research uses. A worthwhile future direction would be to investigate the ability to reproduce results from other stochastic analysis methods. As studies have shifted more to large-scale genomic datasets, many population genetic analysis methods have been developed to account for the increase in available data, even within the topic of clustering algorithms and analyses of population structure \citep{Raj:2014, Petkova:2015, Bradburd:2016}. One would expect more data to produce more consistent results, but it is worth further investigation to examine the validity of this assumption.

In conclusion, my thesis has made valuable contributions to the field of evolutionary biology. These simulation and methods testing studies have highlighted the importance of understanding the demographic history of populations and the impacts this can have on local adaptation. When combined, theoretical and biological insights into evolution provide the most valuable knowledge for advancing our understanding of these processes, and I hope that the results of my work will lead to worthwhile investigations of population genetic processes in species alive today.

% great theme to come back to is the faults in simplified models of evolution


%% For you conclusions chapter, you might want to discuss how range shifts rather than range expansion could change the predictions. of this and the previous chapter.   Add in some of the ideas from your post-doc proposal, perhaps.
%% evolution of dispersal
%% seed vs pollen dispersal
%% range shifts vs pure range expansions


%% stickleback NE and NB ne estimation method